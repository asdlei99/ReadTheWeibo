<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ReadTheWeibo</title>

    <link href="base.css" rel="stylesheet">
    <link href="cards.css" rel="stylesheet">
    <style>
        html, body, #app {height: 100%;}[v-cloak] {display: none;}.wb-item-wrap .card9.card{margin:0}.f-weibo .m-img-box{background-color:#e6e6e6}.empty-bg{width:100%;background-color:#e6e6e6;height:.375rem}.inline-block{display:inline-block}.txt-margin{margin:0 0 1rem 0}.width-min{width:4.375rem}.anim-load{animation:load .5s ease-out;-moz-animation:load .5s ease-out;-webkit-animation:load .5s ease-out;-o-animation:load .5s ease-out}@keyframes load{0%{background-color:#fff}100%{background-color:#e6e6e6}}@-moz-keyframes load{0%{background-color:#fff}100%{background-color:#e6e6e6}}@-webkit-keyframes load{0%{background-color:#fff}100%{background-color:#e6e6e6}}.f-more{letter-spacing:.1rem}.f-weibo .f-card-title{margin:-1rem -1rem .5rem -1rem;padding:0 1rem;border-width:0}.f-weibo .m-avatar-box .m-img-box .m-icon{font-size:14px}.iosx3 .card9 .f-card-title{border-width:0}.iosx2 .card9 .f-card-title{border-width:0}.f-weibo.card9{border-bottom:1px solid #e6e6e6}.iosx3 .f-weibo.card9{border-bottom:.36px solid #e6e6e6}.iosx2 .f-weibo.card9{border-bottom:.5px solid #e6e6e6}.f-weibo.card9>.card-wrap{margin-left:.75rem;margin-right:.75rem}.f-weibo.card9.m-panel{border-top-width:0}.f-weibo.card .card-wrap .f-col-wrap{padding:0 .9375rem}.f-weibo.card9 .m-box-col{min-width:0}.f-weibo.card9 .weibo-top{padding:0 0 0 .25rem}.f-weibo.card9 .weibo-top .m-box-col .m-icon{margin-left:3px}.f-weibo.card9 .weibo-main .weibo-og{padding:.75rem 0 0 .25rem}.f-weibo.card9 .weibo-main .card-wrap ~ .weibo-rp{margin-top:0.5rem}.f-weibo.card9 .weibo-main .media-b{margin:.625rem 0 -.375rem}.f-weibo.card9 .weibo-main .media-b .m-auto-list{margin:0 0 -.25rem}.f-weibo .weibo-top .m-text-box{margin:.15rem 0 .15rem .5rem}.f-weibo .f-r{float:right}.f-weibo .weibo-main .weibo-og{font-size:.9375rem}.f-weibo .weibo-rp .weibo-text{font-size:.9375rem}.f-weibo .weibo-rp .f-footer-ctrl{padding:0.625rem 0 0}.f-weibo .f-bg-img{background-size:cover;background-repeat:no-repeat;background-position:center;position:absolute;width:100%;height:100%}.f-footer-ctrl{border-top-width:0;height:1.1rem;padding: 1rem .375rem 1rem 0;margin: 0 0.75rem}.f-footer-ctrl .m-diy-btn{color:rgba(40,47,60,0.8);height:100%;float:left}.f-footer-ctrl .m-diy-btn+.m-diy-btn{margin-left:1.6875rem}.f-footer-ctrl .m-diy-btn .m-icon{font-size:16px}.f-footer-ctrl aside{float:right;color:rgba(40,47,60,0.8)}.f-footer-ctrl .m-font{font-size:1rem;vertical-align:middle}.f-footer-ctrl .m-diy-btn h4{font-size:.8125rem;display:inline-block;margin-top:0;margin-left:.25rem}
    </style>
    <link href="app.9a344f76.css" rel="stylesheet">
    <style type="text/css">
        .card9 .weibo-main .media-b .m-auto-list{max-width:100%}@media screen and (min-width:750px){.card9 .weibo-main .m-auto-list,.card9 .weibo-main .media-b .m-auto-list{max-width:400px}}.f-media .m-auto-list .m-auto-box1{-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;padding:0}.f-media .m-auto-list .m-auto-box2{width:34%}.f-media .m-auto-list .m-auto-box2,.f-media .m-auto-list .m-auto-box3{-webkit-box-sizing:border-box;box-sizing:border-box;padding:0 .3125rem .3125rem 0}.f-media .m-auto-list .m-auto-box3{width:33.33%}.f-media .m-auto-list .m-imghold-4-3{padding-bottom:100%}.f-media .m-auto-list .m-imghold-16-9{padding-bottom:56.25%;-webkit-box-sizing:border-box;box-sizing:border-box}.f-media .feed-mark{z-index:9}.f-bg-img{background-size:cover;background-repeat:no-repeat;background-position:50%;position:absolute;width:100%;height:100%}.card9 .weibo-main .weibo-media .pay-icon{position:absolute;top:0;right:0;z-index:11}.card9 .weibo-main .weibo-media .pay-icon>img{width:1.875rem;height:1.875rem}
    </style>

    <script src="vue.min.js"></script>
</head>
<body>
    <div id="weibo">
        <div class="wb-item-wrap">
            <div class="wb-item">
                <div class="card m-panel card9 f-weibo" v-if="post">
                    <!-- 作者 -->
                    <div class="card-wrap">
                        <header class="weibo-top m-box">
                            <div class="m-avatar-box m-box-center">
                                <a :href="'https://m.weibo.cn/profile/' + post.userId" class="m-img-box">
                                    <img :src="post.avatarUrl">
                                </a>
                            </div>
                            <div class="m-box-dir m-box-col m-box-center">
                                <div class="m-text-box">
                                    <a :href="'https://m.weibo.cn/profile/' + post.userId">
                                        <h3 class="m-text-cut">{{ post.userName }}</h3>
                                    </a>
                                    <h4 class="m-text-cut">
                                        <span class="time">{{ createTimeStr }}</span>
                                    </h4>
                                </div>
                            </div>
                        </header>
                    </div>
                    <article class="weibo-main">
                        <div class="card-wrap">
                            <div class="weibo-og">
                                <!-- 内容 -->
                                <div class="weibo-text" v-html="post.rawContent">​</div>
                                <!-- 图片 -->
                                <div class="weibo-media-wraps weibo-media f-media media-b" v-if="post.images.length">
                                    <ul class="m-auto-list">
                                        <li class="m-auto-box3" v-for="image in post.images">
                                            <div class="m-img-box m-imghold-4-3">
                                                <a :href="image.largeUrl">
                                                    <div class="f-bg-img" :style="'background-image: url(&quot;' + image.previewUrl + '&quot;);'"></div>
                                                </a>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!-- 转发 -->
                        <div class="weibo-rp" v-if="post.originalPost">
                            <div class="card-wrap">
                                <div class="weibo-text">
                                    <span>
                                        <!-- 作者 -->
                                        <a :href="'https://m.weibo.cn/profile/' + post.originalPost.userId" class="">@{{ post.originalPost.userName }}</a>:
                                    </span>
                                    <!-- 内容 -->
                                    <span v-html="post.originalPost.rawContent"></span>
                                </div>
                                <!-- 图片 -->
                                <div class="weibo-media-wraps weibo-media f-media media-b" v-if="post.originalPost.images.length">
                                    <ul class="m-auto-list">
                                        <li class="m-auto-box3" v-for="image in post.originalPost.images">
                                            <div class="m-img-box m-imghold-4-3">
                                                <a :href="image.largeUrl">
                                                    <div class="f-bg-img" :style="'background-image: url(&quot;' + image.previewUrl + '&quot;);'"></div>
                                                </a>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                                <footer class="f-footer-ctrl">
                                    <aside>
                                        <a :href="'https://m.weibo.cn/detail/' + post.originalPost.id">查看</a>
                                    </aside>
                                </footer>
                            </div>
                        </div>
                    </article>
                    <footer class="f-footer-ctrl">
                        <aside>
                            <a :href="'https://m.weibo.cn/detail/' + post.id">查看</a>
                        </aside>
                    </footer>
                </div>
            </div>
        </div>
    </div>

    <script>
        var weibo = new Vue({
            el: '#weibo',
            data: {
                post: null
            },
            computed: {
                createTimeStr: function () {
                    timeDelta = new Date() - this.post.createTime;
                    if ((timeDelta /= 1000) < 60)
                        return Math.floor(timeDelta) + '秒前';
                    if ((timeDelta /= 60) < 60)
                        return Math.floor(timeDelta) + '分钟前';
                    if ((timeDelta /= 60) < 24)
                        return Math.floor(timeDelta) + '小时前';
                    if ((timeDelta /= 24) < 10)
                        return Math.floor(timeDelta) + '天前';
                    return this.post.createTime.toLocaleString();
                }
            },
            methods: {
                showPost: function (post) {
                    post.rawContent = this.fixRawContent(post.rawContent);
                    post.createTime = new Date(post.createTime);
                    if (post.originalPost)
                        post.originalPost.rawContent = this.fixRawContent(post.originalPost.rawContent);
                    this.post = post;
                },
                fixRawContent: function (rawContent) {
                    // 表情url添加协议
                    res = rawContent.replace( /(<img .*?src=")(\/\/.*?".*?>)/g, '$1https:$2');
                    // 链接使用绝对路径
                    res = res.replace( /(<a .*?href=")(\/.*?".*?>)/g, '$1https://m.weibo.cn$2');
                    return res;
                }
            }
        });

        function showPost (post) {
            weibo.showPost(post);
        }
    </script>
</body>
</html>
